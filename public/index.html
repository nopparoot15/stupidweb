<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>Cyber Spin Portal</title>
<link rel="stylesheet" href="style.css">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
<div class="background"></div>
<div class="container">
  <h1>ğŸŒ Cyberpunk Spin Portal</h1>
  <div class="buttons">
    <button id="openRegister">à¸ªà¸¡à¸±à¸„à¸£à¸ªà¸¡à¸²à¸Šà¸´à¸</button>
    <button id="openLogin">Login</button>
  </div>
  <div id="welcome" class="welcome"></div>
  <button id="logoutBtn" class="logout" style="display:none;">Logout</button>

  <div id="gameArea" style="display:none; margin-top:20px;">
    <h2>ğŸ° Spin the Cyber Wheel!</h2>
    <button id="spinBtn">SPIN!</button>
    <div id="spinResult" style="margin-top:20px; font-size:1.5em;"></div>
  </div>
</div>

<!-- Register Modal -->
<div id="registerModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <h2>à¸ªà¸¡à¸±à¸„à¸£à¸ªà¸¡à¸²à¸Šà¸´à¸</h2>
    <input type="text" id="regUsername" placeholder="Username">
    <input type="password" id="regPassword" placeholder="Password">
    <button id="registerBtn">à¸ªà¸¡à¸±à¸„à¸£</button>
  </div>
</div>

<!-- Login Modal -->
<div id="loginModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <h2>Login</h2>
    <input type="text" id="loginUsername" placeholder="Username">
    <input type="password" id="loginPassword" placeholder="Password">
    <button id="loginBtn">Login</button>
  </div>
</div>

<script>
const registerModal = document.getElementById('registerModal');
const loginModal = document.getElementById('loginModal');
const openRegister = document.getElementById('openRegister');
const openLogin = document.getElementById('openLogin');
const closeBtns = document.querySelectorAll('.close');
const welcome = document.getElementById('welcome');
const logoutBtn = document.getElementById('logoutBtn');
const gameArea = document.getElementById('gameArea');
const spinBtn = document.getElementById('spinBtn');
const spinResult = document.getElementById('spinResult');

openRegister.onclick = () => registerModal.style.display = 'block';
openLogin.onclick = () => loginModal.style.display = 'block';
closeBtns.forEach(btn => btn.onclick = () => { registerModal.style.display='none'; loginModal.style.display='none'; });
window.onclick = e => { if(e.target===registerModal) registerModal.style.display='none'; if(e.target===loginModal) loginModal.style.display='none'; }

// Register
document.getElementById('registerBtn').onclick = async ()=>{
  const username = document.getElementById('regUsername').value;
  const password = document.getElementById('regPassword').value;
  const res = await fetch('/api/register',{method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({username,password})});
  const data = await res.json();
  Swal.fire({icon: data.success?'success':'error', title: data.msg});
  if(data.success){ registerModal.style.display='none'; }
};

// Login
document.getElementById('loginBtn').onclick = async ()=>{
  const username = document.getElementById('loginUsername').value;
  const password = document.getElementById('loginPassword').value;
  const res = await fetch('/api/login',{method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({username,password})});
  const data = await res.json();
  Swal.fire({icon: data.success?'success':'error', title: data.msg});
  if(data.success){
    loginModal.style.display='none';
    welcome.innerHTML = `à¸¢à¸´à¸™à¸”à¸µà¸•à¹‰à¸­à¸™à¸£à¸±à¸š ${data.username}`;
    logoutBtn.style.display='block';
    gameArea.style.display='block';
  }
};

// Logout
logoutBtn.onclick = async ()=>{
  const res = await fetch('/api/logout',{method:'POST'});
  const data = await res.json();
  Swal.fire({icon:'success', title:data.msg});
  welcome.innerHTML='';
  logoutBtn.style.display='none';
  gameArea.style.display='none';
};

// Spin Game
const prizes = [
  "à¸„à¸¸à¸“à¹„à¸”à¹‰à¸£à¸±à¸š Neon Blade âš¡",
  "à¸„à¸¸à¸“à¹„à¸”à¹‰à¸£à¸±à¸š Cyber Helmet ğŸª–",
  "à¸„à¸¸à¸“à¹„à¸”à¹‰à¸£à¸±à¸š Energy Drink ğŸ”‹",
  "à¸„à¸¸à¸“à¹„à¸”à¹‰à¸£à¸±à¸š Virtual Coin ğŸ’°",
  "à¸„à¸¸à¸“à¹„à¸”à¹‰à¸£à¸±à¸š Holo Pet ğŸ¾",
  "à¸„à¸¸à¸“à¹„à¸”à¹‰à¸£à¸±à¸š Nothingâ€¦ Try Again ğŸ˜µ"
];

function randomColor(){ const colors=['#0ff','#f0f','#ff0','#0f0','#f00','#00f']; return colors[Math.floor(Math.random()*colors.length)]; }

spinBtn.onclick = ()=>{
  spinBtn.disabled = true;
  spinBtn.style.transform = "rotate(360deg)";
  spinBtn.style.transition = "transform 1s ease";
  setTimeout(()=>{
    spinBtn.style.transform="rotate(0deg)";
    spinBtn.disabled=false;
    const prize = prizes[Math.floor(Math.random()*prizes.length)];
    spinResult.innerHTML=prize;
    spinResult.style.color=randomColor();
    spinResult.style.textShadow=`0 0 10px ${randomColor()},0 0 20px ${randomColor()}`;
    Swal.fire({icon:'success', title:prize});
  },1000);
};
</script>
</body>
</html>
